<script type="text/javascript">
  function embedVega(chart_spec, elId) {
    function showError(el, error) {
      el.innerHTML = (`
        <div style="color:red;">
          <p>JavaScript Error: ${error.message}</p>
          <p>
            This usually means there is an error in your chart specification.
            See the javascript console for the full traceback.
          </p>
        </div>
      `);
      throw error;
    }
    let el = document.getElementById(elId);
    vegaEmbed('#'+elId, chart_spec, {
      // https://vega.github.io/vega-embed/#options
      "mode": "vega-lite",
      "scaleFactor": { png: 2 }, // scale on export
      "actions": {
        // These don't work in the electron browser context and are
        // not necessarily useful to invest users.
        "compiled": false,
        "source": false,
      }
    })
      // .then(function (result) {
      //   // Access the Vega view instance as result.view
      //   // (https://vega.github.io/vega/docs/api/view/)
      // })
      .catch(error => showError(el, error));
  }
</script>
